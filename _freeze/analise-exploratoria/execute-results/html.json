{
  "hash": "dac2d14a8f864b05459bbbb6f1b62c1b",
  "result": {
    "markdown": "# Análise Exploratória de Dados\n\n## Introdução\n\nA **Análise Exploratória de Dados (EDA)** é uma etapa fundamental em qualquer projeto de análise estatística. Consiste em investigar os dados usando estatísticas descritivas e visualizações para:\n\n-   Compreender a distribuição das variáveis\n-   Identificar padrões e tendências\n-   Detectar valores atípicos (outliers)\n-   Formular hipóteses para análises posteriores\n-   Verificar a qualidade dos dados\n\nNeste capítulo, abordaremos dois componentes essenciais da AED:\n\n1.  **Estatística Descritiva**: Resumir dados usando tabelas e medidas\n2.  **Visualização de Dados**: Criar gráficos informativos com ggplot2\n\n\n## Preparação dos Dados\n\nAntes de iniciar a análise exploratória, precisamos carregar os pacotes necessários e preparar os dados.\n\n### Carregando Pacotes\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)    # Manipulação e visualização\nlibrary(readxl)       # Leitura de Excel\nlibrary(janitor)      # Limpeza de dados\nlibrary(gtsummary)    # Tabelas descritivas\nlibrary(officer)      # Exportação para Word\nlibrary(flextable)    # Tabelas formatadas\nlibrary(ggpubr)       # Gráficos de publicação\nlibrary(sjPlot)       # Tabelas e gráficos\nlibrary(vcd)          # Visualização de dados categóricos\n\n# Remover notação científica\noptions(scipen = 999)\n```\n:::\n\n\n### Importando e Limpando Dados\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Carregar banco de dados\ndados <- read_excel(\"data/dados_internacoes_maringa_2024.xlsx\")\n\n# Pipeline de limpeza\ndados_limpos <- dados |>\n  clean_names() |>                              # Padronizar nomes das colunas\n  filter(cod_idade == \"Anos\") |>               # Filtrar apenas idades em anos\n  select(sexo, val_tot, raca_cor, idade,       # Selecionar colunas relevantes\n         morte, dias_perm, mes_cmpt) |>\n  mutate(                                       # Recodificar raça/cor\n    raca_cor = case_when(\n      raca_cor == '01' ~ \"Branca\",\n      raca_cor == \"02\" ~ \"Preta\",\n      raca_cor == \"03\" ~ \"Parda\",\n      raca_cor == \"04\" ~ \"Amarela\",\n      raca_cor == \"05\" ~ \"Indígena\"\n    )\n  ) |>\n  mutate(across(c(val_tot, idade, dias_perm), as.numeric)) |>  # Converter para numérico\n  mutate(across(c(sexo, raca_cor, morte, mes_cmpt), as.factor))  # Converter para fator\n```\n:::\n\n\n## Estatística Descritiva\n\nA estatística descritiva resume e apresenta as características principais dos dados.\n\n### Medidas de Tendência Central\n\n-   **Média**: Valor médio dos dados\n-   **Mediana**: Valor central quando os dados estão ordenados\n-   **Moda**: Valor mais frequente\n\n### Medidas de Dispersão\n\n-   **Desvio Padrão (DP)**: Variabilidade em torno da média\n-   **Variância**: Quadrado do desvio padrão\n-   **Amplitude**: Diferença entre máximo e mínimo\n-   **Intervalo Interquartil (IQR)**: Diferença entre o 3º e 1º quartil\n\n### Criando Tabelas Descritivas com gtsummary\n\nO pacote **gtsummary** facilita a criação de tabelas descritivas profissionais.\n\n#### Tabela Básica\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Tabela descritiva simples\ndados_limpos |>\n  tbl_summary()\n```\n:::\n\n\n#### Tabela Estratificada\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Tabela estratificada por desfecho (morte)\ntabela_1 <- dados_limpos |>\n  tbl_summary(\n    by = morte,                                                # Estratificar por morte\n    statistic = list(all_continuous() ~ \"{mean} ({sd})\"),    # Média (DP) para contínuas\n    label = list(                                             # Renomear variáveis\n      idade ~ \"Idade (anos)\",\n      sexo ~ \"Sexo\",\n      val_tot ~ \"Valor da internação (Reais)\",\n      raca_cor ~ \"Raça/Cor\",\n      dias_perm ~ \"Dias de permanência\"\n    )\n  ) |>\n  add_overall(col_label = \"**Total**\") |>                    # Adicionar coluna total\n  bold_labels() |>                                            # Negrito nos rótulos\n  modify_header(label = \"**Características avaliadas**\")     # Customizar cabeçalho\n\ntabela_1\n```\n:::\n\n\n#### Personalizando Estatísticas\n\nVocê pode especificar diferentes estatísticas para diferentes tipos de variáveis:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndados_limpos |>\n  tbl_summary(\n    by = sexo,\n    statistic = list(\n      all_continuous() ~ \"{mean} ({sd}) | {median} [{p25}, {p75}]\",\n      all_categorical() ~ \"{n} ({p}%)\"\n    ),\n    digits = all_continuous() ~ 2\n  ) |>\n  add_p() |>                   # Adicionar p-valores\n  add_overall() |>             # Adicionar coluna total\n  bold_p(t = 0.05) |>          # Negrito em p < 0.05\n  bold_labels()\n```\n:::\n\n\n### Exportando Tabelas\n\n#### Exportação para Word\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Converter para flextable\nft <- tabela_1 |>\n  as_flex_table()\n\n# Criar documento Word\ndoc <- read_docx() |>\n  body_add_par(\n    \"Tabela 1: Estatísticas descritivas das internações de Maringá em 2024\",\n    style = \"heading 1\"\n  ) |>\n  body_add_flextable(ft)\n\n# Salvar arquivo\nprint(doc, target = \"tabela_1.docx\")\n```\n:::\n\n\n#### Exportação para Excel\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(openxlsx)\n\n# Criar workbook\nwb <- createWorkbook()\naddWorksheet(wb, \"Tabela Descritiva\")\n\n# Adicionar tabela\nwriteData(wb, sheet = 1, x = tabela_1)\n\n# Salvar\nsaveWorkbook(wb, \"tabela_1.xlsx\", overwrite = TRUE)\n```\n:::\n\n\n## Testes Estatísticos\n\nTestes estatísticos nos permitem fazer inferências sobre a população a partir da amostra.\n\n### Teste de Correlação\n\nA correlação mede a força e direção da associação entre duas variáveis contínuas.\n\n#### Coeficiente de Correlação\n\n-   **Pearson**: Para relações lineares (dados normais)\n-   **Spearman**: Para relações monotônicas (dados não normais ou ordinais)\n-   **Kendall**: Alternativa robusta ao Spearman\n\nValores variam de -1 (correlação negativa perfeita) a +1 (correlação positiva perfeita).\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Correlação de Spearman entre valor total e idade\ncor(x = dados_limpos$val_tot,\n    y = dados_limpos$idade,\n    method = \"spearman\")\n```\n:::\n\n\n#### Visualizando Correlação\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Gráfico de dispersão com linha de regressão\ncorrelation_plot <- ggscatter(\n  dados_limpos,\n  x = \"val_tot\",\n  y = \"idade\",\n  add = \"reg.line\",                             # Adicionar linha de regressão\n  add.params = list(color = \"navyblue\"),        # Customizar linha\n  conf.int = TRUE,                              # Intervalo de confiança\n  cor.coef = TRUE,                              # Mostrar coeficiente\n  cor.method = \"spearman\"                       # Método de correlação\n) +\n  labs(\n    title = \"Correlação entre Valor Total e Idade\",\n    x = \"Valor total da internação (R$)\",\n    y = \"Idade (anos)\"\n  ) +\n  theme_minimal()\n\ncorrelation_plot\n```\n:::\n\n\n#### Matriz de Correlação\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Selecionar apenas variáveis numéricas\ndados_numericos <- dados_limpos |>\n  select(where(is.numeric))\n\n# Calcular matriz de correlação\nmatriz_cor <- cor(dados_numericos, method = \"spearman\", use = \"complete.obs\")\n\n# Visualizar com corrplot\nlibrary(corrplot)\ncorrplot(matriz_cor,\n         method = \"color\",\n         type = \"upper\",\n         addCoef.col = \"black\",\n         tl.col = \"black\",\n         tl.srt = 45,\n         diag = FALSE)\n```\n:::\n\n\n### Teste do Qui-Quadrado\n\nO teste qui-quadrado avalia a associação entre duas variáveis categóricas.\n\n**Hipóteses:**\n\n-   H₀: As variáveis são independentes\n-   H₁: As variáveis são associadas\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Teste qui-quadrado: sexo vs. morte\nresultado_chi <- chisq.test(dados_limpos$sexo, dados_limpos$morte)\nresultado_chi\n```\n:::\n\n\n#### Tabela de Contingência\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Tabela cruzada com percentuais\nsjt.xtab(\n  var.row = dados_limpos$sexo,\n  var.col = dados_limpos$morte,\n  show.cell.prc = TRUE,              # Mostrar percentuais\n  show.row.prc = TRUE,               # Percentuais por linha\n  show.col.prc = TRUE                # Percentuais por coluna\n)\n```\n:::\n\n\n#### Gráfico de Mosaico\n\nGráficos de mosaico visualizam a relação entre variáveis categóricas:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmosaic(~ sexo + morte,\n       data = dados_limpos,\n       shade = TRUE,                  # Colorir por resíduos\n       legend = TRUE,                 # Mostrar legenda\n       main = \"Associação entre Sexo e Mortalidade\")\n```\n:::\n\n\n### Teste t de Student\n\nCompara médias entre dois grupos independentes.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Comparar idade média entre sexos\nt.test(idade ~ sexo, data = dados_limpos)\n\n# Teste t pareado (para dados pareados)\n# t.test(antes, depois, paired = TRUE)\n```\n:::\n\n\n### ANOVA (Análise de Variância)\n\nCompara médias entre três ou mais grupos.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# ANOVA: idade entre categorias de raça/cor\nmodelo_anova <- aov(idade ~ raca_cor, data = dados_limpos)\nsummary(modelo_anova)\n\n# Teste post-hoc (Tukey) para comparações múltiplas\nTukeyHSD(modelo_anova)\n```\n:::\n\n\n## Visualização de Dados com ggplot2\n\nO **ggplot2** é o sistema de visualização mais popular do R, baseado na \"Gramática de Gráficos\".\n\n### Estrutura Básica do ggplot2\n\nTodos os gráficos ggplot2 seguem esta estrutura:\n\n``` r\nggplot(data = <DATA>, mapping = aes(<MAPPINGS>)) +\n  <GEOM_FUNCTION>() +\n  <CUSTOMIZATIONS>\n```\n\n### Tipos de Gráficos\n\n#### Gráfico de Barras\n\nIdeal para variáveis categóricas:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Gráfico de barras simples\nggplot(data = dados_limpos, mapping = aes(x = morte)) +\n  geom_bar() +\n  labs(\n    title = \"Distribuição de Mortalidade\",\n    x = \"Óbito\",\n    y = \"Frequência\"\n  ) +\n  theme_minimal()\n```\n:::\n\n\n#### Gráfico de Barras Agrupadas\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = dados_limpos, mapping = aes(x = sexo, fill = morte)) +\n  geom_bar() +\n  labs(\n    x = \"Sexo\",\n    y = \"Contagem\",\n    title = \"Mortalidade por Sexo em pacientes internados em Maringá\",\n    subtitle = \"Dados de 2024\",\n    caption = \"Fonte: SIH\"\n  ) +\n  scale_fill_manual(\n    name = \"Óbito\",\n    values = c(\"Sim\" = \"darkred\", \"Não\" = \"navy\")\n  ) +\n  theme_minimal()\n```\n:::\n\n\n#### Gráfico de Barras Empilhadas (Proporções)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = dados_limpos, mapping = aes(x = sexo, fill = morte)) +\n  geom_bar(position = \"fill\") +                # position = \"fill\" para proporções\n  labs(\n    x = \"Sexo\",\n    y = \"Proporção\",\n    title = \"Percentual de Mortalidade por Sexo em pacientes internados em Maringá\",\n    subtitle = \"Dados de 2024\",\n    caption = \"Fonte: SIH\"\n  ) +\n  scale_fill_manual(\n    name = \"Óbito\",\n    values = c(\"Sim\" = \"darkred\", \"Não\" = \"navy\")\n  ) +\n  scale_y_continuous(labels = scales::percent) +  # Formatar eixo Y como percentual\n  facet_grid(~ raca_cor) +                        # Separar por raça/cor\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotacionar rótulos\n```\n:::\n\n\n#### Boxplot\n\nMostra a distribuição de variáveis contínuas:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = dados_limpos, mapping = aes(x = sexo, y = idade)) +\n  geom_boxplot(fill = \"lightblue\", outlier.color = \"red\") +\n  labs(\n    title = \"Distribuição de Idade por Sexo\",\n    x = \"Sexo\",\n    y = \"Idade (anos)\"\n  ) +\n  theme_minimal()\n```\n:::\n\n\n**Interpretação do Boxplot:**\n\n-   **Linha central**: Mediana\n-   **Caixa**: Intervalo interquartil (IQR) - contém 50% dos dados\n-   **Linhas (whiskers)**: Extensão até 1.5 × IQR\n-   **Pontos**: Valores atípicos (outliers)\n\n#### Histograma\n\nMostra a distribuição de frequências de uma variável contínua:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = dados_limpos, mapping = aes(x = idade)) +\n  geom_histogram(bins = 30, fill = \"navy\", color = \"white\") +\n  labs(\n    title = \"Distribuição de Idade dos Pacientes\",\n    x = \"Idade (anos)\",\n    y = \"Frequência\"\n  ) +\n  theme_minimal()\n```\n:::\n\n\nVocê pode ajustar o número de bins ou especificar a largura:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Com binwidth específica\nggplot(data = dados_limpos, mapping = aes(x = idade)) +\n  geom_histogram(binwidth = 5, fill = \"navy\", color = \"white\")\n```\n:::\n\n\n#### Gráfico de Dispersão (Scatter Plot)\n\nMostra a relação entre duas variáveis contínuas:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = dados_limpos, mapping = aes(x = idade, y = dias_perm)) +\n  geom_point(alpha = 0.5, color = \"navy\") +   # alpha para transparência\n  geom_smooth(method = \"lm\", color = \"red\") + # Linha de tendência\n  labs(\n    title = \"Relação entre Idade e Dias de Permanência\",\n    x = \"Idade (anos)\",\n    y = \"Dias de permanência\"\n  ) +\n  theme_minimal()\n```\n:::\n\n\n#### Gráfico Hexagonal (para muitos pontos)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = dados_limpos, mapping = aes(x = dias_perm, y = val_tot)) +\n  geom_hex() +                                # Hexágonos para densidade\n  geom_smooth(method = \"glm\", color = \"red\") +\n  labs(\n    x = \"Dias de Permanência\",\n    y = \"Valor Total (R$)\",\n    title = \"Correlação entre Dias de Permanência e Valor Total\",\n    subtitle = \"Dados de 2024\",\n    caption = \"Fonte: SIH\"\n  ) +\n  scale_fill_viridis_c() +                    # Escala de cores viridis\n  theme_minimal()\n```\n:::\n\n\n### Gráficos de Tendência Temporal\n\nVisualizando tendências ao longo do tempo:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Preparar dados: ordenar meses corretamente\nmeses_pt <- c(\"Janeiro\", \"Fevereiro\", \"Março\", \"Abril\", \"Maio\", \"Junho\",\n              \"Julho\", \"Agosto\", \"Setembro\", \"Outubro\", \"Novembro\", \"Dezembro\")\n\ndados_limpos$mes_cmpt <- factor(dados_limpos$mes_cmpt,\n                                levels = 1:12,\n                                labels = meses_pt)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = dados_limpos, aes(x = mes_cmpt, y = val_tot)) +\n  stat_summary(fun = mean, geom = \"line\", aes(group = 1), color = \"navy\", size = 1) +\n  stat_summary(fun = mean, geom = \"point\", color = \"darkred\", size = 3) +\n  labs(\n    title = \"Valor Médio de Internações por Mês\",\n    subtitle = \"Maringá-PR, 2024\",\n    x = \"Mês\",\n    y = \"Valor médio (R$)\",\n    caption = \"Fonte: SIH\"\n  ) +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n:::\n\n\n### Faceting: Múltiplos Gráficos\n\nO faceting permite criar múltiplos gráficos baseados em uma variável categórica:\n\n#### facet_wrap()\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = dados_limpos, aes(x = idade)) +\n  geom_histogram(bins = 30, fill = \"navy\") +\n  facet_wrap(~ raca_cor, ncol = 2) +\n  labs(\n    title = \"Distribuição de Idade por Raça/Cor\",\n    x = \"Idade (anos)\",\n    y = \"Frequência\"\n  ) +\n  theme_minimal()\n```\n:::\n\n\n#### facet_grid()\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = dados_limpos, aes(x = sexo, y = idade, fill = sexo)) +\n  geom_boxplot() +\n  facet_grid(morte ~ raca_cor) +\n  labs(\n    title = \"Idade por Sexo, Raça/Cor e Mortalidade\",\n    x = \"Sexo\",\n    y = \"Idade (anos)\"\n  ) +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n```\n:::\n\n\n### Customizando Temas\n\nO ggplot2 oferece vários temas prontos:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Temas disponíveis\ntheme_minimal()     # Minimalista (recomendado)\ntheme_classic()     # Clássico\ntheme_bw()          # Preto e branco\ntheme_light()       # Leve\ntheme_dark()        # Escuro\ntheme_void()        # Vazio (sem eixos)\n```\n:::\n\n\n#### Criando Tema Personalizado\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Tema personalizado para publicação\ntema_publicacao <- theme_minimal() +\n  theme(\n    plot.title = element_text(size = 16, face = \"bold\", hjust = 0.5),\n    plot.subtitle = element_text(size = 12, hjust = 0.5),\n    axis.title = element_text(size = 12, face = \"bold\"),\n    axis.text = element_text(size = 10),\n    legend.title = element_text(size = 11, face = \"bold\"),\n    legend.text = element_text(size = 10),\n    panel.grid.minor = element_blank()\n  )\n\n# Aplicar ao gráfico\nggplot(dados_limpos, aes(x = sexo, y = idade)) +\n  geom_boxplot() +\n  tema_publicacao\n```\n:::\n\n\n### Salvando Gráficos\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Criar gráfico\np <- ggplot(dados_limpos, aes(x = sexo, fill = morte)) +\n  geom_bar() +\n  theme_minimal()\n\n# Salvar como PNG\nggsave(\"grafico_mortalidade.png\", plot = p, width = 10, height = 6, dpi = 300)\n\n# Salvar como PDF (vetorial)\nggsave(\"grafico_mortalidade.pdf\", plot = p, width = 10, height = 6)\n\n# Salvar como TIFF (para publicação)\nggsave(\"grafico_mortalidade.tiff\", plot = p, width = 10, height = 6, dpi = 600)\n```\n:::\n\n\n## Resumo do Capítulo\n\nNeste capítulo, você aprendeu:\n\n-   **Estatística Descritiva**:\n    -   Criar tabelas descritivas profissionais com `gtsummary`\n    -   Estratificar análises por grupos\n    -   Exportar tabelas para Word e Excel\n-   **Testes Estatísticos**:\n    -   Teste de correlação (Pearson, Spearman)\n    -   Teste qui-quadrado para variáveis categóricas\n    -   Teste t para comparação de médias\n    -   ANOVA para comparação de múltiplos grupos\n-   **Visualização com ggplot2**:\n    -   Gráficos de barras (simples, agrupados, empilhados)\n    -   Boxplots e histogramas\n    -   Gráficos de dispersão e hexagonais\n    -   Gráficos de tendência temporal\n    -   Faceting para múltiplos gráficos\n    -   Customização de temas e cores\n    -   Exportação de gráficos em diferentes formatos\n\nNo próximo capítulo, você aprenderá sobre **modelos de regressão linear e logística**, ferramentas essenciais para análise preditiva em saúde.\n\n## Exercícios Práticos\n\n1.  Crie uma tabela descritiva estratificada por sexo, incluindo p-valores para testar diferenças entre grupos\n\n2.  Teste se existe correlação significativa entre dias de permanência e valor total da internação\n\n3.  Realize um teste qui-quadrado para verificar se existe associação entre raça/cor e mortalidade\n\n4.  Crie um gráfico de barras mostrando a distribuição de internações por mês, colorido por mortalidade\n\n5.  Faça um boxplot comparando dias de permanência entre pacientes que foram a óbito e os que sobreviveram\n\n6.  Crie um gráfico de dispersão mostrando a relação entre idade e valor total, com pontos coloridos por sexo\n\n7.  Desenvolva um painel com 4 gráficos usando faceting para comparar diferentes variáveis\n\n8.  Exporte sua melhor tabela descritiva para Word e seu melhor gráfico como PNG de alta resolução (300 dpi)",
    "supporting": [
      "analise-exploratoria_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}